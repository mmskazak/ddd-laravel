## Рассылки (Broadcasts)

Теперь перейдём к рассылкам. Сами по себе рассылки достаточно просты —
нам нужно хранить базовую информацию: тему письма и его содержимое.

Но, как видно из пользовательских историй, когда мы отправляем рассылку,
нужно **фильтровать подписчиков** по определённым критериям. Эти фильтры могут быть:

* Одна или несколько **форм**
* Один или несколько **тегов**

Это можно реализовать как минимум двумя способами.

### Отдельные таблицы для фильтров

Такое решение выглядит вот так:

+----------------+        +------------------+        +----------------+
|    forms       |        |    broadcasts    |        |      tags      |
+----------------+        +------------------+        +----------------+
| id             |<--+    | id               |    +-->| id             |
| name           |   |    | subject          |    |   | name           |
+----------------+   |    | content          |    |   +----------------+
                     |    +------------------+    |
                     |                            |
+---------------------+                    +---------------------+
|  broadcast_form      |                  |   broadcast_tag       |
+----------------------+                  +----------------------+
| broadcast_id         |----------------->| broadcast_id         |
| form_id              |                  | tag_id               |
+----------------------+                  +----------------------+

Это **неплохое решение**, но я вижу несколько потенциальных проблем:

* Нужно создать **две дополнительные таблицы** и, возможно, **шесть Eloquent-связей**,
  чтобы реализовать фильтрацию по тегам и формам.

* Я не люблю предугадывать будущее, но **фильтры почти всегда эволюционируют**.
  И как пользователь ConvertKit, могу сказать, что в production-системе e-mail маркетинга
  также встречаются фильтры, такие как:

  * **Лендинги** (аналогично формам)
  * **Сегменты** — подмножества подписчиков по определённым критериям
  * **Продукты и покупки** — интеграция с e-commerce
  * **Интеграции с внешними сервисами**, например, продуктами из Gumroad

---

Martin Joo — Предметно-ориентированное проектирование с Laravel
Стр. 73 / 327

